participant Client
participant DAL
participant KMS
participant Data Lake

Client->DAL:get_data(token)

DAL->DAL:role = authenticate_user(token)

DAL->KMS:get_key(role)
DAL<--KMS:return key

DAL->Data Lake:retrieve_data()
DAL<--Data Lake:return data

DAL->DAL:decrypt_parquet(data, key)

Client<--DAL:return data